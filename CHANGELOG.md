# سجل التغييرات (Changelog)

جميع التغييرات المهمة في هذا المشروع سيتم توثيقها في هذا الملف.

التنسيق مبني على [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)،
وهذا المشروع يتبع [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [غير منشور]

### مخطط للإضافة
- تنفيذ وظائف إدارة المرضى الكاملة (إضافة، تعديل، بحث، حذف)
- تنفيذ وظائف إدارة التحاليل الكاملة (طلب تحاليل، إدخال نتائج، إدارة أنواع التحاليل)
- نظام الطباعة المتقدم والتقارير التفصيلية
- نظام النسخ الاحتياطي التلقائي
- واجهة الإعدادات المتقدمة

## [1.2.0] - 2024-05-27

### أضيف
- **الواجهة الرئيسية المحدثة والتنقل المتطور**:
  - تصميم جديد كلياً بألوان النظام المحددة (أزرق داكن، برتقالي، أخضر فاتح)
  - قائمة جانبية ديناميكية مع تأثيرات انتقال سلسة
  - شريط علوي مع معلومات المستخدم وساعة النظام الحية
  - صفحة ترحيبية جديدة مع إحصائيات وإجراءات سريعة
  - مؤشرات للأقسام النشطة ونظام تنقل بصري
  
- **واجهة إدارة المستخدمين الكاملة**:
  - إضافة مستخدمين جدد مع validation شامل
  - تعديل بيانات المستخدمين الموجودين
  - حذف المستخدمين (عدا المستخدم الحالي)
  - إعادة تعيين كلمات المرور للمستخدمين
  - بحث وتصفية متقدمة
  - جدول معلومات مفصل مع ألوان مميزة للأدوار

- **UserControls أساسية للأقسام**:
  - PatientManagementControl: إدارة المرضى مع واجهة حديثة
  - SearchEditControl: البحث والتعديل مع فلاتر متقدمة
  - ResultEntryControl: إدخال النتائج مع نماذج تفاعلية
  - ReportViewControl: معاينة وطباعة التقارير
  - SettingsControl: إعدادات النظام الشاملة

### محسن
- **نظام Commands محسن**:
  - RelayCommand عام مع دعم المعاملات الجنيسة
  - RelayCommand<T> للأوامر التي تتطلب معاملات
  - إدارة أفضل لحالة الأزرار (CanExecute)

- **Value Converters متقدمة**:
  - NullToVisibilityConverter: إظهار/إخفاء حسب القيم الفارغة
  - NavigationItemConverter: مساعدات التنقل
  - UserFormTitleConverter & PasswordLabelConverter: لواجهة إدارة المستخدمين

- **تجربة المستخدم**:
  - رسائل حالة ديناميكية في شريط الحالة
  - تحديث الوقت والتاريخ المباشر
  - تصميم responsive يتكيف مع أحجام الشاشة
  - تأثيرات بصرية وانتقالات سلسة

### تقني
- **بنية معمارية محسنة**:
  - فصل RelayCommand إلى ملف مستقل في مجلد Helpers
  - تنظيم أفضل للـ ViewModels مع dependency injection
  - استخدام متقدم لنمط MVVM
  - إدارة memory محسنة للـ UserControls

- **نظام ألوان متسق**:
  - أزرق داكن (#1e3a8a): اللون الأساسي
  - برتقالي (#f59e0b): للعناوين والأزرار البارزة
  - أخضر فاتح (#10b981): للأزرار الفرعية والنجاح
  - ألوان إضافية للحالات المختلفة

## [1.1.0] - 2024-05-27

### أضيف
- **نظام تسجيل الدخول الشامل**:
  - واجهة تسجيل دخول أنيقة مع تصميم حديث
  - خيار إظهار/إخفاء كلمة المرور
  - رسائل خطأ واضحة باللغة العربية
  - تأثيرات بصرية وشعار النظام
  
- **نظام الصلاحيات المتقدم**:
  - SystemUser: صلاحيات كاملة (إدارة مستخدمين، سجل الدخول/الخروج)
  - AdminUser: جميع المهام عدا إدارة المستخدمين وسجل الدخول/الخروج
  - RegularUser: إضافة/تعديل مرضى، إدخال نتائج، معاينة وطباعة (بدون حذف)
  
- **نظام سجل الدخول/الخروج**:
  - تسجيل تلقائي لكل دخول وخروج
  - تتبع مدة الجلسة بدقة
  - واجهة عرض السجل مع إمكانية التصفية بالتاريخ
  - خيار حذف السجلات للمستخدمين المصرح لهم
  
- **تحديثات الواجهة الرئيسية**:
  - عرض معلومات المستخدم الحالي ودوره
  - تطبيق نظام الصلاحيات على القوائم والأزرار
  - زر تسجيل خروج مع تأكيد
  - إحصائيات محدثة من قاعدة البيانات
  
- **ViewModels متطورة**:
  - LoginViewModel مع إدارة حالة التحميل
  - MainViewModel مع دعم نظام الصلاحيات
  - LoginLogViewModel لإدارة سجل الدخول
  
- **Value Converters**:
  - محولات لدعم واجهة المستخدم (Visibility, Boolean, String)
  - دعم نظام الصلاحيات في واجهة المستخدم
  
- **تحديث البيانات الأولية**:
  - مستخدم افتراضي جديد: Manager/0000
  - صلاحيات SystemUser للمستخدم الافتراضي

### تحسين
- هيكل MVVM محسن مع فصل أفضل للاهتمامات
- إدارة أفضل لحقن التبعيات
- تسجيل محسن لجلسات المستخدمين مع تتبع مدة الجلسة
- واجهة مستخدم أكثر استجابة مع تأثيرات بصرية
- معالجة أخطاء محسنة مع رسائل واضحة

### إصلاح
- إصلاح مشاكل في تتبع جلسات المستخدمين
- تحسين استقرار التطبيق عند بدء التشغيل
- إصلاح مشاكل في عرض البيانات الإحصائية

### التفاصيل التقنية
- إضافة 3 ViewModels جديدة
- إضافة 2 نوافذ جديدة (Login, LoginLog)
- إضافة 6 Value Converters
- تحديث نظام المصادقة مع تسجيل محسن
- تحديث الواجهة الرئيسية مع دعم الصلاحيات

## [1.0.0] - 2024-05-27

### أضيف
- إعداد المشروع الأولي مع .NET 8.0 و WPF
- نمط MVVM الأساسي
- قاعدة بيانات SQLite مع Entity Framework Core
- نماذج البيانات الكاملة:
  - User (المستخدمين)
  - Patient (المرضى)
  - TestType (أنواع التحاليل)
  - TestGroup (مجموعات التحاليل)
  - PatientTest (طلبات التحاليل)
  - TestResult (نتائج التحاليل)
  - LoginLog (سجل الدخول)
- طبقة الخدمات الشاملة:
  - IUserService و UserService
  - IPatientService و PatientService
  - ITestService و TestService
  - IAuthenticationService و AuthenticationService
  - IReportService و ReportService
- أدوات مساعدة:
  - DatabaseHelper (مساعد قاعدة البيانات)
  - PasswordHelper (مساعد كلمات المرور)
  - ValidationHelper (مساعد التحقق)
- تشفير كلمات المرور باستخدام BCrypt
- الواجهة الرئيسية مع لوحة التحكم
- دعم اللغة العربية (RTL)
- نظام حقن التبعيات
- إعدادات التطبيق الشاملة
- مستخدم مدير افتراضي (admin/admin123)
- ملفات التوثيق والترخيص

### التفاصيل التقنية
- إطار العمل: .NET 8.0
- واجهة المستخدم: WPF
- قاعدة البيانات: SQLite
- ORM: Entity Framework Core 8.0
- تشفير كلمات المرور: BCrypt.Net-Next
- نمط التصميم: MVVM
- حقن التبعيات: Microsoft.Extensions.DependencyInjection

### البيانات الأولية
- مستخدم مدير افتراضي
- مجموعات تحاليل أساسية (كيمياء، هرمونات، دم)
- أنواع تحاليل أساسية (سكر، كوليسترول، TSH، CBC)

### الأمان
- تشفير كلمات المرور
- تسجيل محاولات تسجيل الدخول
- نظام الأدوار والصلاحيات
- حماية من حقن SQL

### الوثائق
- README.md شامل بالعربية والإنجليزية
- تعليقات كاملة في الكود
- توثيق هيكل قاعدة البيانات
- دليل التثبيت والإعداد

### الملفات الإضافية
- .gitignore محدث
- App.config مع إعدادات شاملة
- LICENSE (MIT)
- CHANGELOG.md
